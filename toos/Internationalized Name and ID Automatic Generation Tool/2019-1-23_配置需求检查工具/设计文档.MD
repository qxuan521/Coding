# 详细设计

#### 标准数据读取问题

标准表为.csv文件 由于标准表的格式比较固定（一列为有前缀ID，另一列为内容）并且数据量比较大，如果使用Com 的方式读取效率非常低，所以标准表的读取采用文件流的方式进行读取，能够提高很多效率.而且由于工具在使用的时候如果每一次操作（**填写，检查**）都重新阅读标准表的话，性能消耗很大而且意义不是很大，所以设计旨在程序开始是预读一次，并且根据预读结果生成双向（ID->name，name->ID）的映射（Dictionary），方便查找。（一次预读问题如果需要的话可以提供一个刷新接口，重新读。）

 #### 工作表问题

难点主要是对工作表中内容的确定

![1548903071601](E:\需求分析\2019-1-23_配置需求检查工具\表格.png)

根据约束

> “所有的表头会出现 [男物品、男ID、女物品、女ID] 中至少一对（同男或同女），表结束时会出现一行没有数据的单元格，其他情况均视为表格不符合要求。”

按照上述方式确定有效数据列的位置，有效数据行的开始，以及有效数据行的结束。（有效数据的定义：男物品、男ID、女物品、女ID，四列的数据）。

#### 路径保持问题

1. 书写配置文件。

#### 拖拽

实现将工作文件直接拖入文本框以达到选择文件的效果。